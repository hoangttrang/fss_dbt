SELECT 
	   r.region,
      s.translated_site,
	SUM(CASE WHEN a.month = 'January' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS january_camera_obstruction,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS january_cell_phone,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'crash' THEN 1 ELSE 0 END) AS january_crash,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS january_distraction,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS january_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS january_drowsiness,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS january_forward_collision_warning,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS january_manual_event,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS january_near_miss,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS january_ran_a_red_light,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS january_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS january_seat_belt_violation,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS january_speeding,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS january_stop_sign_violation,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS january_tailgating,
    SUM(CASE WHEN a.month = 'January' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS january_unsafe_lane_change,
    -- February
    SUM(CASE WHEN a.month = 'February' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS february_camera_obstruction,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS february_cell_phone,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'crash' THEN 1 ELSE 0 END) AS february_crash,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS february_distraction,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS february_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS february_drowsiness,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS february_forward_collision_warning,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS february_manual_event,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS february_near_miss,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS february_ran_a_red_light,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS february_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS february_seat_belt_violation,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS february_speeding,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS february_stop_sign_violation,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS february_tailgating,
    SUM(CASE WHEN a.month = 'February' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS february_unsafe_lane_change,
    --March
    SUM(CASE WHEN a.month = 'March' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS march_camera_obstruction,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS march_cell_phone,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'crash' THEN 1 ELSE 0 END) AS march_crash,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS march_distraction,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS march_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS march_drowsiness,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS march_forward_collision_warning,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS march_manual_event,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS march_near_miss,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS march_ran_a_red_light,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS march_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS march_seat_belt_violation,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS march_speeding,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS march_stop_sign_violation,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS march_tailgating,
    SUM(CASE WHEN a.month = 'March' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS march_unsafe_lane_change,
    --April
    SUM(CASE WHEN a.month = 'April' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS april_camera_obstruction,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS april_cell_phone,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'crash' THEN 1 ELSE 0 END) AS april_crash,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS april_distraction,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS april_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS april_drowsiness,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS april_forward_collision_warning,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS april_manual_event,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS april_near_miss,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS april_ran_a_red_light,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS april_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS april_seat_belt_violation,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS april_speeding,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS april_stop_sign_violation,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS april_tailgating,
    SUM(CASE WHEN a.month = 'April' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS april_unsafe_lane_change,
    --May
    SUM(CASE WHEN a.month = 'May' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS may_camera_obstruction,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS may_cell_phone,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'crash' THEN 1 ELSE 0 END) AS may_crash,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS may_distraction,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS may_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS may_drowsiness,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS may_forward_collision_warning,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS may_manual_event,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS may_near_miss,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS may_ran_a_red_light,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS may_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS may_seat_belt_violation,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS may_speeding,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS may_stop_sign_violation,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS may_tailgating,
    SUM(CASE WHEN a.month = 'May' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS may_unsafe_lane_change,
    --June
    SUM(CASE WHEN a.month = 'June' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS june_camera_obstruction,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS june_cell_phone,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'crash' THEN 1 ELSE 0 END) AS june_crash,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS june_distraction,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS june_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS june_drowsiness,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS june_forward_collision_warning,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS june_manual_event,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS june_near_miss,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS june_ran_a_red_light,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS june_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS june_seat_belt_violation,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS june_speeding,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS june_stop_sign_violation,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS june_tailgating,
    SUM(CASE WHEN a.month = 'June' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS june_unsafe_lane_change,
    --July
    SUM(CASE WHEN a.month = 'July' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS july_camera_obstruction,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS july_cell_phone,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'crash' THEN 1 ELSE 0 END) AS july_crash,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS july_distraction,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS july_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS july_drowsiness,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS july_forward_collision_warning,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS july_manual_event,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS july_near_miss,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS july_ran_a_red_light,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS july_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS july_seat_belt_violation,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS july_speeding,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS july_stop_sign_violation,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS july_tailgating,
    SUM(CASE WHEN a.month = 'July' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS july_unsafe_lane_change,
    --August
    SUM(CASE WHEN a.month = 'August' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS august_camera_obstruction,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS august_cell_phone,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'crash' THEN 1 ELSE 0 END) AS august_crash,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS august_distraction,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS august_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS august_drowsiness,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS august_forward_collision_warning,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS august_manual_event,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS august_near_miss,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS august_ran_a_red_light,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS august_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS august_seat_belt_violation,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS august_speeding,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS august_stop_sign_violation,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS august_tailgating,
    SUM(CASE WHEN a.month = 'August' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS august_unsafe_lane_change,
    --September
    SUM(CASE WHEN a.month = 'September' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS september_camera_obstruction,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS september_cell_phone,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'crash' THEN 1 ELSE 0 END) AS september_crash,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS september_distraction,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS september_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS september_drowsiness,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS september_forward_collision_warning,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS september_manual_event,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS september_near_miss,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS september_ran_a_red_light,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS september_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS september_seat_belt_violation,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS september_speeding,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS september_stop_sign_violation,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS september_tailgating,
    SUM(CASE WHEN a.month = 'September' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS september_unsafe_lane_change,
    --October
    SUM(CASE WHEN a.month = 'October' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS october_camera_obstruction,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS october_cell_phone,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'crash' THEN 1 ELSE 0 END) AS october_crash,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS october_distraction,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS october_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS october_drowsiness,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS october_forward_collision_warning,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS october_manual_event,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS october_near_miss,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS october_ran_a_red_light,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS october_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS october_seat_belt_violation,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS october_speeding,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS october_stop_sign_violation,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS october_tailgating,
    SUM(CASE WHEN a.month = 'October' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS october_unsafe_lane_change,
    --November
    SUM(CASE WHEN a.month = 'November' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS november_camera_obstruction,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS november_cell_phone,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'crash' THEN 1 ELSE 0 END) AS november_crash,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS november_distraction,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS november_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS november_drowsiness,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS november_forward_collision_warning,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS november_manual_event,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS november_near_miss,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS november_ran_a_red_light,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS november_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS november_seat_belt_violation,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS november_speeding,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS november_stop_sign_violation,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS november_tailgating,
    SUM(CASE WHEN a.month = 'November' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS november_unsafe_lane_change,
    --December
    SUM(CASE WHEN a.month = 'December' AND a.type = 'camera_obstruction' THEN 1 ELSE 0 END) AS december_camera_obstruction,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'cell_phone' THEN 1 ELSE 0 END) AS december_cell_phone,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'crash' THEN 1 ELSE 0 END) AS december_crash,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'distraction' THEN 1 ELSE 0 END) AS december_distraction,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'driver_facing_cam_obstruction' THEN 1 ELSE 0 END) AS december_driver_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'drowsiness' THEN 1 ELSE 0 END) AS december_drowsiness,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'forward_collision_warning' THEN 1 ELSE 0 END) AS december_forward_collision_warning,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'manual_event' THEN 1 ELSE 0 END) AS december_manual_event,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'near_miss' THEN 1 ELSE 0 END) AS december_near_miss,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'ran_a_red_light' THEN 1 ELSE 0 END) AS december_ran_a_red_light,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'road_facing_cam_obstruction' THEN 1 ELSE 0 END) AS december_road_facing_cam_obstruction,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'seat_belt_violation' THEN 1 ELSE 0 END) AS december_seat_belt_violation,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'speeding' THEN 1 ELSE 0 END) AS december_speeding,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'stop_sign_violation' THEN 1 ELSE 0 END) AS december_stop_sign_violation,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'tailgating' THEN 1 ELSE 0 END) AS december_tailgating,
    SUM(CASE WHEN a.month = 'December' AND a.type = 'unsafe_lane_change' THEN 1 ELSE 0 END) AS december_unsafe_lane_change
FROM {{ ref('stg_motive_data_combined_events') }} a 
JOIN {{ ref('stg_motive_data_vehicle_group_mappings') }} b
ON a.vehicle_id = b.vehicle_id
LEFT JOIN {{ ref('int_site_translation') }} s 
ON b.group_name = s.site
LEFT JOIN {{ ref('int_region_translation') }}  r 
ON b.group_name = r.site
WHERE 1=1
AND a.coaching_status <> 'uncoachable'
AND start_date between '2025-01-01' AND '2025-02-01'
group by r.region, s.translated_site